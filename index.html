<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <script>
        document.write('<meta name="version" content="' + Date.now() + '">');
    </script>
    <meta charset="UTF-8">
    <title>NEW PROUD NAILS</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>

<meta name="description" content="NEW PROUD NAILS - ä¸“ä¸šç¾ç”²æœåŠ¡ï¼Œä½“éªŒä¼˜é›…ä¸ç¾ä¸½">
<meta name="theme-color" content="#667eea">
<script src="config-sound.js"></script>
<style>
* {
  user-select: none;
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html, body {
  width: 100%;
  height: 100%;
  overflow: hidden;
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  background-size: 110% 110%;
  background-position: center center;
  background-attachment: fixed;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
  transition: background-position 0.1s ease-out;
}

.language-switcher {
  position: absolute;
  bottom: calc(14% + 200px);
  width: 100%;
  display: flex;
  justify-content: center;
  gap: 15px;
  z-index: 998;
  padding: 0 20px;
}

.lang-btn {
  min-width: 90px;
  height: 45px;
  background: rgba(255, 255, 255, 0.25);
  backdrop-filter: blur(20px);
  border: 2px solid rgba(255, 255, 255, 0.45);
  border-radius: 12px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
  color: rgba(255, 255, 255, 0.95);
  font-size: 15px;
  font-weight: 700;
  text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
  cursor: pointer;
  transition: all 0.3s ease;
}

.lang-btn:hover {
  background: rgba(255, 255, 255, 0.35);
  transform: translateY(-3px);
}

.lang-btn.active {
  background: rgba(255, 255, 255, 0.5);
  border-color: rgba(255, 255, 255, 0.7);
  transform: translateY(-2px);
}

#logo {
  position: absolute;
  top: 96px;
  left: 50%;
  transform: translateX(-50%);
  width: 100%;
  text-align: center;
  font-size: clamp(96px, 10vw, 128px);
  font-weight: 800;
  letter-spacing: 3px;
  background: #FF5B5F;
  background-size: cover;
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  text-shadow: 
    2px 2px 0px rgba(255, 255, 255, 0.4),
    3px 3px 0px rgba(255, 255, 255, 0.3);
  z-index: 2;
  cursor: pointer;
  filter: brightness(1.1) contrast(1.1);
}

/* Uå­—æ¯ä½œä¸ºæ”¶é›†å®¹å™¨ - ç™½è‰²é—ªå…‰ */
.letter-u {
  position: relative;
  display: inline-block;
  color: #FFFFFF;
  -webkit-text-fill-color: #FFFFFF;
  font-weight: 900;
  transition: all 0.5s ease;
  animation: uGlow 2s ease-in-out infinite;
  filter: drop-shadow(0 0 8px rgba(255, 255, 255, 0.8));
}

@keyframes uGlow {
  0%, 100% {
    filter: drop-shadow(0 0 8px rgba(255, 255, 255, 0.6))
            drop-shadow(0 0 15px rgba(255, 255, 255, 0.4));
  }
  50% {
    filter: drop-shadow(0 0 15px rgba(255, 255, 255, 0.9))
            drop-shadow(0 0 25px rgba(255, 255, 255, 0.6))
            drop-shadow(0 0 35px rgba(200, 200, 255, 0.4));
  }
}

.letter-u.tilting {
  animation: tiltU 1s ease-out forwards;
}

@keyframes tiltU {
  0% { transform: rotate(0deg); }
  50% { transform: rotate(45deg) translateY(20px); }
  100% { transform: rotate(90deg) translateY(40px) translateX(100px); }
}

.score-display {
  position: fixed;
  top: 30px;
  right: 30px;
  background: rgba(255, 255, 255, 0.3);
  backdrop-filter: blur(15px);
  padding: 15px 25px;
  border-radius: 15px;
  border: 2px solid rgba(255, 255, 255, 0.5);
  z-index: 999;
  text-align: center;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 5px;
}

.music-toggle {
  position: absolute;
  top: 8px;
  left: 8px;
  width: 36px;
  height: 36px;
  border: none;
  background: rgba(255, 255, 255, 0.2);
  backdrop-filter: blur(10px);
  border-radius: 50%;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 18px;
  transition: all 0.3s ease;
  border: 2px solid rgba(255, 255, 255, 0.3);
}

.music-toggle:hover {
  background: rgba(255, 255, 255, 0.4);
  transform: scale(1.1);
}

.music-toggle.muted {
  background: rgba(255, 59, 63, 0.3);
  border-color: rgba(255, 59, 63, 0.5);
}

.score-label {
  font-size: 14px;
  color: rgba(255, 255, 255, 0.9);
  font-weight: 600;
  margin-bottom: 5px;
  margin-top: 5px;
}

.score-value {
  font-size: 32px;
  font-weight: 800;
  color: #fff;
  text-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
}

.ball-count {
  font-size: 13px;
  color: rgba(255, 255, 255, 0.8);
  font-weight: 600;
  margin-top: 2px;
}

/* é¢„çº¦é¢æ¿æ ‡é¢˜æ  - ç«–å‘å¸ƒå±€ */
.panel-title-container {
  display: flex;
  flex-direction: column;
  align-items: center;
  text-align: center;
  flex: 1;
  margin-right: 20px;
}

.panel-title-text {
  font-size: 38px;
  font-weight: 900;
  color: rgba(255, 255, 255, 0.98);
  text-shadow: 0 2px 0 rgba(0, 0, 0, 0.25), 0 5px 12px rgba(0, 0, 0, 0.4);
  letter-spacing: 2px;
  margin-bottom: 15px;
}

.panel-title-clock {
  font-size: 18px;
  font-weight: 700;
  color: rgba(255, 255, 255, 0.95);
  text-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
  font-family: 'Courier New', monospace;
  letter-spacing: 1px;
  display: flex;
  flex-direction: column;
  align-items: center;
}

.panel-clock-time-inline {
  font-size: 28px;
  margin-bottom: 6px;
  font-weight: 800;
}

.panel-clock-date-inline {
  font-size: 18px;
  opacity: 0.95;
  font-weight: 600;
}

.light-dot {
  position: absolute;
  width: 60px;
  height: 60px;
  border-radius: 50%;
  border: 3px solid rgba(255, 255, 255, 0.95);
  box-shadow: 0 0 40px rgba(255, 255, 255, 0.95), 0 0 120px rgba(255, 255, 255, 0.7);
  backdrop-filter: blur(4px);
  cursor: pointer;
  z-index: 3;
  display: flex;
  align-items: center;
  justify-content: center;
  opacity: 0;
  top: -100px;
  transition: opacity 1.5s cubic-bezier(0.34, 1.56, 0.64, 1);
}

.light-dot.visible { opacity: 1; }
.light-dot.scared { animation: shake 0.3s ease; }

@keyframes shake {
  0%, 100% { transform: rotate(0deg); }
  25% { transform: rotate(-10deg) scale(0.95); }
  75% { transform: rotate(10deg) scale(0.95); }
}

.face {
  position: relative;
  width: 40px;
  height: 40px;
  border-radius: 50%;
  background: rgba(255, 255, 255, 0.25);
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
}

.eyes {
  display: flex;
  justify-content: space-between;
  width: 100%;
  margin-bottom: 2px;
}

.eye {
  position: relative;
  width: 26px;
  height: 34px;
}

.eye-white {
  width: 100%;
  height: 100%;
  background: #fff;
  border-radius: 50% / 60%;
  border: 1px solid rgba(0, 0, 0, 0.2);
  transition: all 0.2s ease;
}

.pupil {
  width: 12px;
  height: 12px;
  background: #000;
  border-radius: 50%;
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  transition: all 0.1s ease;
}

.eye.scared .eye-white {
  width: 120%;
  height: 120%;
  margin-left: -10%;
  margin-top: -10%;
}

.eye.scared .pupil {
  width: 8px;
  height: 8px;
}

.eye.closed .eye-white {
  height: 2px;
  border-radius: 2px;
}

.mouth {
  width: 12px;
  height: 6px;
  border-bottom: 2px solid #000;
  border-radius: 0 0 6px 6px;
  transition: all 0.2s ease;
}

.mouth.scared {
  width: 16px;
  height: 16px;
  border-radius: 50%;
  border: 2px solid #000;
}

.speech-bubble {
  position: absolute;
  background: rgba(255, 255, 255, 0.95);
  border-radius: 20px;
  padding: 12px 20px;
  font-size: 18px;
  font-weight: 600;
  color: #FF3B3F;
  box-shadow: 0 8px 24px rgba(0, 0, 0, 0.2);
  z-index: 4;
  opacity: 0;
  transition: opacity 0.5s ease, transform 0.5s ease;
  pointer-events: none;
  transform: translateX(-50%) translateY(-10px);
}

.speech-bubble.show {
  opacity: 1;
  transform: translateX(-50%) translateY(0);
}

.speech-bubble::after {
  content: '';
  position: absolute;
  bottom: -8px;
  left: 50%;
  transform: translateX(-50%);
  width: 0;
  height: 0;
  border-left: 10px solid transparent;
  border-right: 10px solid transparent;
  border-top: 10px solid rgba(255, 255, 255, 0.95);
}

#buttons {
  position: absolute;
  bottom: 14%;
  left: 50%;
  transform: translateX(-50%);
  width: 100%;
  display: flex;
  justify-content: center;
  gap: 20px;
  z-index: 2;
  flex-wrap: wrap;
  padding: 0 20px;
}

.glass-btn {
  min-width: 140px;
  height: 60px;
  border-radius: 18px;
  background: rgba(255, 255, 255, 0.28);
  backdrop-filter: blur(12px);
  border: 1px solid rgba(255, 255, 255, 0.65);
  box-shadow: 0 18px 36px rgba(0, 0, 0, 0.18), inset 0 1px 0 rgba(255, 255, 255, 0.6);
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: 700;
  font-size: 16px;
  color: #fff;
  text-shadow: 0 2px 4px rgba(0, 0, 0, 0.35);
  cursor: pointer;
  transition: transform 0.12s ease, box-shadow 0.12s ease;
  position: relative;
  overflow: hidden;
  padding: 0 15px;
}

.glass-btn:active {
  transform: translateY(2px) scale(0.97);
}

.glass-btn.satisfied {
  animation: giftPulse 0.5s ease-in-out 3;
}

@keyframes giftPulse {
  0%, 100% { transform: scale(1); }
  50% { transform: scale(1.2); }
}

#promoCard {
  position: absolute;
  width: 90%;
  max-width: 400px;
  height: 250px;
  border-radius: 24px;
  background: linear-gradient(135deg, #FF3B3F, #FF6B6F);
  box-shadow: 0 24px 48px rgba(0, 0, 0, 0.4);
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  font-weight: 700;
  color: #fff;
  cursor: pointer;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%) scale(0);
  opacity: 0;
  transition: transform 0.8s cubic-bezier(0.34, 1.56, 0.64, 1), opacity 0.8s ease;
  z-index: 10;
  text-align: center;
  padding: 20px;
}

#promoCard.show {
  transform: translate(-50%, -50%) scale(1);
  opacity: 1;
}

.promo-text {
  font-size: 32px;
  margin-bottom: 10px;
}

.promo-subtitle {
  font-size: 18px;
  opacity: 0.9;
}

#fireworkCanvas {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  z-index: 9;
  pointer-events: none;
}

.panel-overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.55);
  backdrop-filter: blur(6px);
  z-index: 998;
  opacity: 0;
  visibility: hidden;
  transition: opacity 0.8s ease, visibility 0.8s ease;
}

.panel-overlay.show {
  opacity: 1;
  visibility: visible;
}

.function-detail-panel {
  position: fixed;
  top: 0;
  left: -100%;
  width: 85%;
  max-width: 600px;
  height: 100%;
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(100px) saturate(300%) brightness(1.15) contrast(1.1);
  border-right: 8px solid rgba(255, 255, 255, 0.7);
  box-shadow: 
    16px 0 120px rgba(0, 0, 0, 0.7),
    12px 0 80px rgba(0, 0, 0, 0.5);
  z-index: 999;
  transition: left 1.5s cubic-bezier(0.16, 0.84, 0.44, 1);
  overflow-y: auto;
}

.function-detail-panel.show {
  left: 0;
}

.panel-header {
  position: sticky;
  top: 0;
  background: rgba(255, 255, 255, 0.35);
  backdrop-filter: blur(25px);
  padding: 30px;
  border-bottom: 3px solid rgba(255, 255, 255, 0.5);
  display: flex;
  justify-content: space-between;
  align-items: center;
  z-index: 10;
}

.panel-title {
  font-size: 38px;
  font-weight: 900;
  color: rgba(255, 255, 255, 0.98);
  text-shadow: 0 2px 0 rgba(0, 0, 0, 0.25), 0 5px 12px rgba(0, 0, 0, 0.4);
  letter-spacing: 2px;
}

.panel-close-btn {
  width: 54px;
  height: 54px;
  background: rgba(255, 255, 255, 0.3);
  backdrop-filter: blur(12px);
  border: 3px solid rgba(255, 255, 255, 0.6);
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: all 0.3s ease;
  font-size: 32px;
  color: rgba(255, 255, 255, 0.95);
  text-shadow: 0 2px 8px rgba(0, 0, 0, 0.4);
}

.panel-close-btn:hover {
  background: rgba(255, 255, 255, 0.5);
  transform: scale(1.15) rotate(90deg);
  box-shadow: 0 4px 24px rgba(0, 0, 0, 0.35);
}

.panel-content {
  padding: 40px 30px;
  min-height: calc(100% - 130px);
}

.content-section {
  background: rgba(255, 255, 255, 0.18);
  backdrop-filter: blur(18px);
  border-radius: 22px;
  padding: 32px;
  margin-bottom: 28px;
  border: 2px solid rgba(255, 255, 255, 0.35);
  box-shadow: 0 10px 40px rgba(0, 0, 0, 0.25);
}

.section-title {
  font-size: 26px;
  font-weight: 800;
  color: rgba(255, 255, 255, 0.98);
  margin-bottom: 18px;
  text-shadow: 0 2px 5px rgba(0, 0, 0, 0.35);
}

.section-text {
  font-size: 17px;
  line-height: 1.9;
  color: rgba(255, 255, 255, 0.92);
  text-shadow: 0 1px 4px rgba(0, 0, 0, 0.35);
}

.feature-list {
  list-style: none;
  padding: 0;
  margin: 22px 0;
}

.feature-item {
  background: rgba(255, 255, 255, 0.25);
  padding: 17px 22px;
  margin-bottom: 14px;
  border-radius: 14px;
  border-left: 5px solid rgba(255, 255, 255, 0.7);
  color: rgba(255, 255, 255, 0.98);
  font-size: 17px;
  text-shadow: 0 1px 4px rgba(0, 0, 0, 0.35);
  transition: all 0.3s ease;
}

.feature-item:hover {
  background: rgba(255, 255, 255, 0.35);
  transform: translateX(12px);
}

/* å¯å±•å¼€èœå•æ ·å¼ */
.expandable-section {
  background: rgba(255, 255, 255, 0.18);
  backdrop-filter: blur(18px);
  border-radius: 22px;
  padding: 0;
  margin-bottom: 28px;
  border: 2px solid rgba(255, 255, 255, 0.35);
  box-shadow: 0 10px 40px rgba(0, 0, 0, 0.25);
  overflow: hidden;
}

.section-header {
  padding: 25px 32px;
  cursor: pointer;
  display: flex;
  justify-content: space-between;
  align-items: center;
  transition: all 0.3s ease;
  user-select: none;
}

.section-header:hover {
  background: rgba(255, 255, 255, 0.1);
}

.section-header:active {
  background: rgba(255, 255, 255, 0.15);
}

.expand-icon {
  font-size: 24px;
  transition: transform 0.3s ease;
  color: rgba(255, 255, 255, 0.9);
}

.expand-icon.expanded {
  transform: rotate(180deg);
}

.section-details {
  max-height: 0;
  overflow: hidden;
  transition: max-height 0.4s ease, padding 0.4s ease;
  padding: 0 32px;
}

.section-details.expanded {
  max-height: 1000px;
  padding: 0 32px 25px 32px;
}

.detail-item {
  padding: 12px 18px;
  margin-bottom: 10px;
  background: rgba(255, 255, 255, 0.15);
  border-radius: 10px;
  color: rgba(255, 255, 255, 0.95);
  font-size: 16px;
  display: flex;
  justify-content: space-between;
  align-items: center;
  transition: all 0.2s ease;
}

.detail-item:hover {
  background: rgba(255, 255, 255, 0.25);
  transform: translateX(8px);
}

.detail-name {
  flex: 1;
}

.detail-price {
  font-weight: 800;
  color: #FFD700;
  text-shadow: 0 1px 3px rgba(0, 0, 0, 0.5);
  font-size: 18px;
}

.action-button {
  width: 100%;
  padding: 20px;
  background: rgba(255, 255, 255, 0.35);
  backdrop-filter: blur(12px);
  border: 3px solid rgba(255, 255, 255, 0.7);
  border-radius: 16px;
  color: rgba(255, 255, 255, 0.98);
  font-size: 19px;
  font-weight: 800;
  text-shadow: 0 2px 5px rgba(0, 0, 0, 0.35);
  cursor: pointer;
  transition: all 0.3s ease;
  margin-top: 24px;
}

.action-button:hover {
  background: rgba(255, 255, 255, 0.5);
  transform: translateY(-4px);
  box-shadow: 0 10px 30px rgba(0, 0, 0, 0.35);
}

@media (max-width: 400px) and (max-height: 700px) {
  #logo {
    top: 60px;
    font-size: clamp(70px, 10vw, 90px);
  }
  
  .glass-btn {
    min-width: 110px;
    height: 50px;
    font-size: 14px;
  }
  
  .lang-btn {
    min-width: 70px;
    height: 38px;
    font-size: 13px;
  }
  
  .language-switcher {
    gap: 8px;
    bottom: calc(14% + 70px);
  }
  
  #buttons {
    gap: 12px;
  }
  
  .score-display {
    top: 15px;
    right: 15px;
    padding: 10px 15px;
  }
  
  .score-value {
    font-size: 24px;
  }
}
</style>
</head>
<body>

<div class="panel-overlay" id="panelOverlay" onclick="closeFunctionPanel()"></div>

<div class="function-detail-panel" id="functionPanel">
  <div class="panel-header">
    <div class="panel-title" id="panelTitle">é¢„çº¦</div>
    <div class="panel-close-btn" onclick="closeFunctionPanel()">Ã—</div>
  </div>
  <div class="panel-content" id="panelContentArea"></div>
</div>

<div class="score-display">
  <button class="music-toggle" id="musicToggle" onclick="toggleMusic()" title="éŸ³ä¹å¼€å…³">
    <span id="musicIcon">ğŸ”Š</span>
  </button>
  <div class="score-label">Score</div>
  <div class="score-value" id="scoreValue">0</div>
  <div class="ball-count" id="ballCount">(0/20)</div>
</div>

<div id="logo" onclick="playLogoSound()">NEW PRO<span class="letter-u" id="letterU">U</span>D NAILS</div>

<div class="light-dot">
  <div class="face">
    <div class="eyes">
      <div class="eye"><div class="eye-white"></div><div class="pupil"></div></div>
      <div class="eye"><div class="eye-white"></div><div class="pupil"></div></div>
    </div>
    <div class="mouth"></div>
  </div>
</div>

<div class="speech-bubble">å“ˆå–½ï¼</div>

<div class="language-switcher">
  <button class="lang-btn active" data-lang="zh" onclick="switchLanguage('zh')">ä¸­æ–‡</button>
  <button class="lang-btn" data-lang="en" onclick="switchLanguage('en')">English</button>
  <button class="lang-btn" data-lang="es" onclick="switchLanguage('es')">EspaÃ±ol</button>
</div>

<div id="buttons">
  <div class="glass-btn" onclick="clickButton('book')"><span id="btnBook">é¢„çº¦</span></div>
  <div class="glass-btn" id="giftBtn">
    <span><span id="btnGiftFull">GIFT</span><span id="ballCount2"></span></span>
  </div>
  <div class="glass-btn" onclick="clickButton('services')"><span id="btnServices">æœåŠ¡</span></div>
  <div class="glass-btn" onclick="clickButton('member')"><span id="btnMember">ä¼šå‘˜</span></div>
</div>

<div id="promoCard">
  <div class="promo-text">ğŸ æ­å–œï¼</div>
  <div class="promo-subtitle">æ‚¨è·å¾—äº†ä¸“å±ä¼˜æƒ </div>
</div>

<canvas id="fireworkCanvas"></canvas>

<script>
// ========== å…¨å±€å˜é‡ ==========
let currentScore = 0;
let totalBalls = 0;
const TARGET_SCORE = 20;
let tiltX = 0;
let tiltY = 0;
let currentLanguage = 'zh';
let ballsInU = [];

// ========== éŸ³æ•ˆç®¡ç†ç³»ç»Ÿï¼ˆå®Œæ•´ç‰ˆï¼‰ ==========
const AudioManager = {
  bgm: null,
  sounds: {},
  voices: {},
  
  init: function() {
    if (typeof ASSETS === 'undefined') {
      console.warn('config-sound.jsæœªåŠ è½½ï¼ŒéŸ³æ•ˆç³»ç»Ÿæœªåˆå§‹åŒ–');
      return;
    }
    
    // åˆå§‹åŒ–èƒŒæ™¯éŸ³ä¹
    if (ASSETS.sounds && ASSETS.sounds.bgm) {
      this.bgm = new Audio(ASSETS.sounds.bgm);
      this.bgm.loop = true;
      this.bgm.volume = ASSETS.audioSettings.bgmVolume;
    }
    
    // åˆå§‹åŒ–éŸ³æ•ˆ
    if (ASSETS.sounds) {
      Object.keys(ASSETS.sounds).forEach(key => {
        if (key !== 'bgm' && ASSETS.sounds[key]) {
          this.sounds[key] = new Audio(ASSETS.sounds[key]);
          this.sounds[key].volume = ASSETS.audioSettings.effectVolume;
        }
      });
    }
    
    // åŠ è½½å½“å‰è¯­è¨€çš„è¯­éŸ³
    this.loadVoices(currentLanguage);
  },
  
  loadVoices: function(lang) {
    if (typeof ASSETS === 'undefined' || !ASSETS.languages || !ASSETS.languages[lang]) {
      return;
    }
    
    const voices = ASSETS.languages[lang].voice;
    if (voices) {
      Object.keys(voices).forEach(key => {
        this.voices[key] = new Audio(voices[key]);
        this.voices[key].volume = ASSETS.audioSettings.voiceVolume;
      });
    }
  },
  
  playBGM: function() {
    if (this.bgm && typeof ASSETS !== 'undefined' && ASSETS.audioSettings && ASSETS.audioSettings.enableBGM) {
      this.bgm.play().catch(e => console.log('BGMæ’­æ”¾éœ€è¦ç”¨æˆ·äº¤äº’'));
    }
  },
  
  stopBGM: function() {
    if (this.bgm) {
      this.bgm.pause();
      this.bgm.currentTime = 0;
    }
  },
  
  stopAllAudio: function() {
    if (this.bgm) {
      this.bgm.pause();
      this.bgm.currentTime = 0;
    }
    Object.values(this.sounds).forEach(sound => {
      if (sound) {
        sound.pause();
        sound.currentTime = 0;
      }
    });
    Object.values(this.voices).forEach(voice => {
      if (voice) {
        voice.pause();
        voice.currentTime = 0;
      }
    });
  },
  
  playSound: function(soundName) {
    if (this.sounds[soundName] && typeof ASSETS !== 'undefined' && ASSETS.audioSettings && ASSETS.audioSettings.enableEffects) {
      this.sounds[soundName].currentTime = 0;
      this.sounds[soundName].play().catch(e => console.log('éŸ³æ•ˆæ’­æ”¾å¤±è´¥'));
    }
  },
  
  playVoice: function(voiceName) {
    if (this.voices[voiceName] && typeof ASSETS !== 'undefined' && ASSETS.audioSettings && ASSETS.audioSettings.enableVoice) {
      this.voices[voiceName].currentTime = 0;
      this.voices[voiceName].play().catch(e => console.log('è¯­éŸ³æ’­æ”¾å¤±è´¥'));
    }
  }
};

// ========== DOMå…ƒç´  ==========
const dot = document.querySelector(".light-dot");
const eyes = dot.querySelectorAll(".eye");
const mouth = document.querySelector(".mouth");
const speechBubble = document.querySelector(".speech-bubble");
const giftBtn = document.getElementById("giftBtn");
const letterU = document.getElementById("letterU");
const ballCountDisplay = document.getElementById("ballCount");
const scoreDisplay = document.getElementById("scoreValue");
const promoCard = document.getElementById("promoCard");
const canvas = document.getElementById("fireworkCanvas");
const ctx = canvas.getContext("2d");

canvas.width = innerWidth;
canvas.height = innerHeight;

const centerX = innerWidth / 2;
const centerY = innerHeight / 2;
const groundY = innerHeight - 150;

let walkTimer, mouseX = centerX, mouseY = centerY;
let clickCount = 0, isScared = false;
let balls = [];

// åˆå§‹ä½ç½®åœ¨ä¸Šæ–¹
dot.style.left = `${centerX - 30}px`;
dot.style.top = `-100px`;

// ========== è§¦å±å¯åŠ¨ç³»ç»Ÿ ==========
window.addEventListener('load', () => {
  let hasStarted = false;
  
  function startEverything() {
    if (hasStarted) return;
    hasStarted = true;
    
    // åˆå§‹åŒ–éŸ³æ•ˆç³»ç»Ÿ
    AudioManager.init();
    
    // å¼€å¯èƒŒæ™¯éŸ³ä¹
    AudioManager.playBGM();
    
    // ç²¾çµä»ä¸Šæ–¹é£˜è½
    dot.style.transition = 'top 1.5s cubic-bezier(0.34, 1.56, 0.64, 1)';
    dot.style.top = `${centerY - 30}px`;
    dot.classList.add('visible');
    
    AudioManager.playSound('spriteAppear');
    
    setTimeout(() => {
      let greetingText = 'å“ˆå–½ï¼';
      if (typeof ASSETS !== 'undefined' && ASSETS.languages && ASSETS.languages[currentLanguage]) {
        greetingText = ASSETS.languages[currentLanguage].greeting;
      }
      
      showSpeechBubble(greetingText, 3000);
      AudioManager.playVoice('greeting');
      
      startRandomWalk();
      blinkEyes();
    }, 1500);
  }
  
  // ç­‰å¾…ç”¨æˆ·è§¦å±/ç‚¹å‡»
  document.addEventListener('click', startEverything, { once: true });
  document.addEventListener('touchstart', startEverything, { once: true });
  
  // é™€èºä»ªï¼ˆæ‰‹æœºï¼‰
  if (window.DeviceOrientationEvent) {
    window.addEventListener('deviceorientation', (e) => {
      if (e.gamma !== null && e.beta !== null) {
        tiltX = e.gamma / 90;
        tiltY = (e.beta - 45) / 90;
      }
    });
  }
  
  // é¼ æ ‡æ§åˆ¶ï¼ˆç”µè„‘ï¼‰- é¼ æ ‡ä½ç½®æ§åˆ¶çƒçš„æ»šåŠ¨æ–¹å‘
  document.addEventListener('mousemove', (e) => {
    // è®¡ç®—é¼ æ ‡ç›¸å¯¹äºå±å¹•ä¸­å¿ƒçš„ä½ç½®
    const centerX = window.innerWidth / 2;
    const centerY = window.innerHeight / 2;
    
    // å½’ä¸€åŒ–åˆ° -1 åˆ° 1 çš„èŒƒå›´ï¼Œå¹¶æ”¾å¤§çµæ•åº¦
    tiltX = ((e.clientX - centerX) / centerX) * 1.5;
    tiltY = ((e.clientY - centerY) / centerY) * 1.5;
    
    // é™åˆ¶èŒƒå›´
    tiltX = Math.max(-1.5, Math.min(1.5, tiltX));
    tiltY = Math.max(-1.5, Math.min(1.5, tiltY));
  });
  
  // è§¦æ‘¸æ§åˆ¶ï¼ˆè§¦å±è®¾å¤‡ï¼‰
  document.addEventListener('touchmove', (e) => {
    if (e.touches.length > 0) {
      const touch = e.touches[0];
      const centerX = window.innerWidth / 2;
      const centerY = window.innerHeight / 2;
      
      // å½’ä¸€åŒ–åˆ° -1 åˆ° 1 çš„èŒƒå›´
      tiltX = ((touch.clientX - centerX) / centerX) * 1.5;
      tiltY = ((touch.clientY - centerY) / centerY) * 1.5;
      
      // é™åˆ¶èŒƒå›´
      tiltX = Math.max(-1.5, Math.min(1.5, tiltX));
      tiltY = Math.max(-1.5, Math.min(1.5, tiltY));
    }
  }, { passive: true });
});

function showSpeechBubble(text, duration = 3000) {
  const dotRect = dot.getBoundingClientRect();
  speechBubble.textContent = text;
  speechBubble.style.left = `${dotRect.left + dotRect.width / 2}px`;
  speechBubble.style.top = `${dotRect.top - 50}px`;
  speechBubble.classList.add('show');
  setTimeout(() => speechBubble.classList.remove('show'), duration);
}

function updatePupils() {
  eyes.forEach(eye => {
    const pupil = eye.querySelector(".pupil");
    const rect = eye.getBoundingClientRect();
    const cx = rect.left + rect.width / 2;
    const cy = rect.top + rect.height / 2;
    const dx = mouseX - cx;
    const dy = mouseY - cy;
    const max = 10;
    pupil.style.left = 50 + Math.max(-max, Math.min(dx / 10, max)) + "%";
    pupil.style.top = 50 + Math.max(-max, Math.min(dy / 10, max)) + "%";
  });
}

document.addEventListener("mousemove", e => {
  mouseX = e.clientX;
  mouseY = e.clientY;
  updatePupils();
});

document.addEventListener("touchmove", e => {
  if (e.touches.length > 0) {
    mouseX = e.touches[0].clientX;
    mouseY = e.touches[0].clientY;
    updatePupils();
  }
}, { passive: true });

function blinkEyes() {
  eyes.forEach(eye => eye.classList.add("closed"));
  setTimeout(() => eyes.forEach(eye => eye.classList.remove("closed")), 100);
  setTimeout(() => blinkEyes(), 2000 + Math.random() * 3000);
}

function showScaredFace() {
  isScared = true;
  eyes.forEach(eye => eye.classList.add("scared"));
  mouth.classList.add("scared");
  dot.classList.add("scared");
  
  setTimeout(() => {
    eyes.forEach(eye => eye.classList.remove("scared"));
    mouth.classList.remove("scared");
    dot.classList.remove("scared");
    isScared = false;
  }, 800);
}

function startRandomWalk() {
  walkTimer = setInterval(() => {
    if (isScared) return;
    
    let x, y;
    const leaveScreen = Math.random() < 0.2;
    
    if (leaveScreen) {
      const side = Math.floor(Math.random() * 4);
      switch(side) {
        case 0: x = -100; y = Math.random() * innerHeight; break;
        case 1: x = innerWidth + 100; y = Math.random() * innerHeight; break;
        case 2: x = Math.random() * innerWidth; y = -100; break;
        case 3: x = Math.random() * innerWidth; y = innerHeight + 100; break;
      }
      
      dot.style.transition = 'left 2s ease-out, top 2s ease-out';
      dot.style.left = `${x}px`;
      dot.style.top = `${y}px`;
      
      setTimeout(() => {
        const returnX = Math.random() * (innerWidth - 60);
        const returnY = Math.random() * (innerHeight - 200) + 100;
        dot.style.left = `${returnX}px`;
        dot.style.top = `${returnY}px`;
      }, 2500);
    } else {
      x = Math.random() * (innerWidth - 60);
      y = Math.random() * (innerHeight - 200) + 100;
      
      const dx = x - mouseX;
      const dy = y - mouseY;
      const dist = Math.hypot(dx, dy);
      if (dist < 150) {
        x += dx / dist * 100;
        y += dy / dist * 100;
        x = Math.max(0, Math.min(innerWidth - 60, x));
        y = Math.max(0, Math.min(innerHeight - 200, y));
      }
      
      dot.style.transition = 'left 2s ease-out, top 2s ease-out';
      dot.style.left = `${x}px`;
      dot.style.top = `${y}px`;
    }
  }, 3000);
}

function handleDotClick(e) {
  e.preventDefault();
  e.stopPropagation();
  clickCount++;
  
  if (clickCount === 1) {
    showScaredFace();
    AudioManager.playSound('spriteEscape');
    
    const currentX = parseFloat(dot.style.left);
    const currentY = parseFloat(dot.style.top);
    const angle = Math.random() * Math.PI * 2;
    const distance = 150;
    const escapeX = currentX + Math.cos(angle) * distance;
    const escapeY = currentY + Math.sin(angle) * distance;
    
    dot.style.transition = 'left 0.3s cubic-bezier(0.34, 1.56, 0.64, 1), top 0.3s cubic-bezier(0.34, 1.56, 0.64, 1)';
    dot.style.left = `${Math.max(0, Math.min(innerWidth - 60, escapeX))}px`;
    dot.style.top = `${Math.max(0, Math.min(innerHeight - 200, escapeY))}px`;
    
    setTimeout(() => {
      dot.style.transition = 'left 2s ease-out, top 2s ease-out';
    }, 300);
  } else if (clickCount === 2) {
    showScaredFace();
    AudioManager.playSound('spriteHit');
    function animateBall(ball) {
  const gravity = 0.6;
  const bounce = 0.55;
  const friction = 0.96;   // åªä½œç”¨äºæ°´å¹³é€Ÿåº¦
  const tiltStrength = 1.2; // é™€èºä»ªæ§åˆ¶åŠ›åº¦ï¼ˆéå¸¸è‡ªç„¶ï¼‰

  function update() {
    if (ball.eaten) return;

    // 1. é‡åŠ›ï¼ˆåªå½±å“ vyï¼‰
    ball.vy += gravity;

    // 2. é™€èºä»ªæ§åˆ¶ï¼ˆæ­£ç¡®æ–¹å‘ï¼‰
    ball.vx += tiltX * tiltStrength;  // å·¦å³
    ball.vy += tiltY * 0.2;           // å‰åè½»å¾®å½±å“ï¼Œä¸ç ´åé‡åŠ›

    // 3. æ‘©æ“¦ï¼ˆåªå½±å“æ°´å¹³é€Ÿåº¦ï¼‰
    ball.vx *= friction;

    // 4. ä½ç½®æ›´æ–°
    ball.x += ball.vx;
    ball.y += ball.vy;

    // 5. åœ°é¢ç¢°æ’
    if (ball.y >= groundY) {
      ball.y = groundY;
      ball.vy = -ball.vy * bounce;

      if (Math.abs(ball.vy) < 1) ball.vy = 0;

      if (!ball.hasPlayedSound && Math.abs(ball.vy) > 2) {
        AudioManager.playSound('ballDrop');
        ball.hasPlayedSound = true;
      }
    }

    // 6. å·¦å³è¾¹ç•Œ
    if (ball.x < 0) {
      ball.x = 0;
      ball.vx = -ball.vx * 0.5;
    }
    if (ball.x > innerWidth - 40) {
      ball.x = innerWidth - 40;
      ball.vx = -ball.vx * 0.5;
    }

    // 7. æ›´æ–° DOM
    ball.element.style.left = `${ball.x}px`;
    ball.element.style.top = `${ball.y}px`;

    checkUCollection(ball);

    if (!ball.eaten) requestAnimationFrame(update);
  }

  update();
}  
  setTimeout(() => {
    giftBtn.classList.add('satisfied');
  }, 2000);
  
  setTimeout(() => {
    fireworkBurst(centerX, centerY);
    AudioManager.playSound('promoAppear');
  }, 2500);
  
  setTimeout(() => {
    promoCard.classList.add('show');
  }, 4000);
}

function fireworkBurst(x, y) {
  const particles = [];
  const colors = ['#FF3B3F', '#FFD700', '#32CD32', '#1E90FF', '#FF69B4', '#FFA500'];
  
  for (let i = 0; i < 100; i++) {
    const angle = Math.random() * 2 * Math.PI;
    const speed = 2 + Math.random() * 5;
    const size = 2 + Math.random() * 4;
    particles.push({
      x, y,
      dx: Math.cos(angle) * speed,
      dy: Math.sin(angle) * speed,
      color: colors[Math.floor(Math.random() * colors.length)],
      size,
      alpha: 1
    });
  }
  
  let frames = 0;
  function animate() {
    frames++;
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    particles.forEach(p => {
      p.x += p.dx;
      p.y += p.dy;
      p.dy += 0.08;
      p.alpha *= 0.97;
      const c = parseInt(p.color.slice(1), 16);
      const rgb = `${(c >> 16) & 255}, ${(c >> 8) & 255}, ${c & 255}`;
      ctx.fillStyle = `rgba(${rgb}, ${p.alpha})`;
      ctx.beginPath();
      ctx.arc(p.x, p.y, p.size, 0, 2 * Math.PI);
      ctx.fill();
    });
    if (frames < 60) requestAnimationFrame(animate);
    else ctx.clearRect(0, 0, canvas.width, canvas.height);
  }
  animate();
}

promoCard.onclick = () => {
  promoCard.classList.remove('show');
  setTimeout(() => {
    currentScore = 0;
    totalBalls = 0;
    ballsInU = [];
    scoreDisplay.textContent = '0';
    ballCountDisplay.textContent = '(0/20)';
    letterU.classList.remove('tilting');
    giftBtn.classList.remove('satisfied');
    dot.style.display = 'flex';
    dot.style.left = `${centerX - 30}px`;
    dot.style.top = `${centerY - 30}px`;
    startRandomWalk();
  }, 300);
};

function playLogoSound() {
  AudioManager.playSound('logoClick');
}

// ========== éŸ³ä¹æ§åˆ¶ ==========
let isMusicMuted = false;

function loadMusicState() {
  try {
    const saved = localStorage.getItem('musicMuted');
    if (saved !== null) {
      isMusicMuted = saved === 'true';
      updateMusicButton();
      if (isMusicMuted) {
        AudioManager.stopBGM();
      }
    }
  } catch (e) {
    console.log('æ— æ³•è¯»å–éŸ³ä¹çŠ¶æ€');
  }
}

function saveMusicState() {
  try {
    localStorage.setItem('musicMuted', isMusicMuted.toString());
  } catch (e) {
    console.log('æ— æ³•ä¿å­˜éŸ³ä¹çŠ¶æ€');
  }
}

function updateMusicButton() {
  const button = document.getElementById('musicToggle');
  const icon = document.getElementById('musicIcon');
  if (button && icon) {
    if (isMusicMuted) {
      icon.textContent = 'ğŸ”‡';
      button.classList.add('muted');
      button.title = 'ç‚¹å‡»å¼€å¯éŸ³ä¹';
    } else {
      icon.textContent = 'ğŸ”Š';
      button.classList.remove('muted');
      button.title = 'ç‚¹å‡»å…³é—­éŸ³ä¹';
    }
  }
}

function toggleMusic() {
  isMusicMuted = !isMusicMuted;
  
  if (isMusicMuted) {
    AudioManager.stopBGM();
  } else {
    AudioManager.playBGM();
  }
  
  updateMusicButton();
  saveMusicState();
}

window.addEventListener('DOMContentLoaded', () => {
  loadMusicState();
});

document.addEventListener('visibilitychange', () => {
  if (document.hidden) {
    AudioManager.stopAllAudio();
  }
});

function switchLanguage(lang) {
  currentLanguage = lang;
  document.querySelectorAll('.lang-btn').forEach(btn => {
    btn.classList.toggle('active', btn.dataset.lang === lang);
  });
  AudioManager.loadVoices(lang);
  updateTexts();
  localStorage.setItem('preferredLanguage', lang);
  updateClock();
}

function updateTexts() {
  if (typeof ASSETS === 'undefined' || !ASSETS.languages || !ASSETS.languages[currentLanguage]) {
    return;
  }
  
  const texts = ASSETS.languages[currentLanguage];
  
  document.getElementById('btnBook').textContent = texts.buttonBook;
  document.getElementById('btnGiftFull').textContent = texts.buttonGift;
  document.getElementById('btnServices').textContent = texts.buttonServices;
  document.getElementById('btnMember').textContent = texts.buttonMember;
}

function updateClock() {
  const now = new Date();
  const hours = String(now.getHours()).padStart(2, '0');
  const minutes = String(now.getMinutes()).padStart(2, '0');
  const seconds = String(now.getSeconds()).padStart(2, '0');
  const timeString = `${hours}:${minutes}:${seconds}`;
  
  const panelClockTimeInline = document.getElementById('panelClockTimeInline');
  const panelClockDateInline = document.getElementById('panelClockDateInline');
  
  if (panelClockTimeInline && panelClockDateInline) {
    panelClockTimeInline.textContent = timeString;
    
    const month = now.getMonth() + 1;
    const date = now.getDate();
    const weekdays = ['å‘¨æ—¥', 'å‘¨ä¸€', 'å‘¨äºŒ', 'å‘¨ä¸‰', 'å‘¨å››', 'å‘¨äº”', 'å‘¨å…­'];
    const weekday = weekdays[now.getDay()];
    
    if (currentLanguage === 'zh') {
      panelClockDateInline.textContent = `${month}æœˆ${date}æ—¥ ${weekday}`;
    } else if (currentLanguage === 'en') {
      const monthNames = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
      const weekdaysEn = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
      panelClockDateInline.textContent = `${monthNames[month-1]} ${date}, ${weekdaysEn[now.getDay()]}`;
    } else if (currentLanguage === 'es') {
      const monthNamesEs = ['Ene', 'Feb', 'Mar', 'Abr', 'May', 'Jun', 'Jul', 'Ago', 'Sep', 'Oct', 'Nov', 'Dic'];
      const weekdaysEs = ['Dom', 'Lun', 'Mar', 'MiÃ©', 'Jue', 'Vie', 'SÃ¡b'];
      panelClockDateInline.textContent = `${date} ${monthNamesEs[month-1]}, ${weekdaysEs[now.getDay()]}`;
    }
  }
}

setInterval(updateClock, 1000);

const panelContents = {
  zh: {
    book: {
      title: 'ğŸ“… åœ¨çº¿é¢„çº¦',
      sections: [
        {
          title: 'ğŸ’… MANICURE',
          collapsible: true,
          items: [
            { name: 'Regular Mani', price: '$12' },
            { name: 'Color Gel Mani', price: '$30' },
            { name: 'Powder Gel Mani', price: '$45' }
          ]
        },
        {
          title: 'ğŸ¦¶ PEDICURE',
          collapsible: true,
          items: [
            { name: 'Regular Pedi', price: '$22' },
            { name: 'Color Gel Pedi', price: '$40' }
          ]
        },
        {
          title: 'ğŸ§– SPA',
          collapsible: true,
          items: [
            { name: 'Basic Mani', price: '$22' },
            { name: 'Basic Pedi', price: '$40' },
            { name: 'Deluxe Pedi', price: '$55' },
            { name: 'Hot Stone', price: '$80' },
            { name: 'Jelly', price: '$90' }
          ]
        },
        {
          title: 'ğŸ’ FILL IN',
          collapsible: true,
          items: [
            { name: 'Acrylic', price: '$32' },
            { name: 'Fiberglass', price: '$35' },
            { name: 'UV Gel', price: '$40' }
          ]
        },
        {
          title: 'âœ¨ FULL SET',
          collapsible: true,
          items: [
            { name: 'Acrylic', price: '$42' },
            { name: 'Fiberglass', price: '$50' },
            { name: 'UV Gel', price: '$65' }
          ]
        },
        {
          title: 'ğŸ€ FRENCH',
          collapsible: true,
          items: [
            { name: 'Acrylic French', price: '$60' },
            { name: 'UV Gel French', price: '$75' }
          ]
        },
        {
          title: 'ğŸ“ è”ç³»æ–¹å¼',
          collapsible: false,
          features: [
            'ğŸ“± (516) 371-4557',
            'ğŸ’¬ (917) 330-5781',
            'ğŸ“ 97 Doughty Blvd Inwood NY 11096',
            'â° å‘¨äºŒè‡³å‘¨æ—¥ 9:58-18:58'
          ]
        }
      ],
      action: 'ç«‹å³é¢„çº¦'
    },
    services: {
      title: 'ğŸ’… æœåŠ¡é¡¹ç›®',
      sections: [
        {
          title: 'ğŸ’… ç¾ç”²æŠ¤ç†',
          collapsible: true,
          items: [
            { name: 'ç»å…¸ç¾ç”²', price: '$12èµ·' },
            { name: 'å‡èƒ¶ç¾ç”²', price: '$30èµ·' },
            { name: 'ç²‰é›•ç¾ç”²', price: '$45èµ·' },
            { name: 'ç¾ç”²ä¿®å¤', price: '$8èµ·' },
            { name: 'æŒ‡ç”²æŠ›å…‰', price: '$5' }
          ]
        },
        {
          title: 'ğŸ¦¶ ç¾è¶³æŠ¤ç†',
          collapsible: true,
          items: [
            { name: 'ç»å…¸ç¾è¶³', price: '$22èµ·' },
            { name: 'å‡èƒ¶ç¾è¶³', price: '$40èµ·' },
            { name: 'å»æ­»çš®æŠ¤ç†', price: '+$10' },
            { name: 'è¶³éƒ¨æŒ‰æ‘©', price: '+$15' },
            { name: 'è„šè·Ÿä¿®å¤', price: '+$8' }
          ]
        },
        {
          title: 'ğŸ¨ æŒ‡ç”²è‰ºæœ¯',
          collapsible: true,
          items: [
            { name: 'æ³•å¼ç¾ç”²', price: '+$10' },
            { name: 'æ¸å˜ç¾ç”²', price: '+$15' },
            { name: 'å½©ç»˜è®¾è®¡', price: '+$20' },
            { name: 'æ°´æ™¶è£…é¥°', price: '+$5èµ·' },
            { name: 'è´´é’»æœåŠ¡', price: '+$3èµ·' }
          ]
        },
        {
          title: 'âœ¨ ç‰¹æ®ŠæŠ¤ç†',
          collapsible: true,
          items: [
            { name: 'çŸ³èœ¡èœ¡ç–—', price: '+$12' },
            { name: 'çƒ­çŸ³æŒ‰æ‘©', price: '+$25' },
            { name: 'æ·±å±‚ä¿æ¹¿', price: '+$15' },
            { name: 'Jelly Spa', price: '+$20' },
            { name: 'é¦™è–°æŠ¤ç†', price: '+$10' }
          ]
        },
        {
          title: 'ğŸ’ ç”²ç‰‡æœåŠ¡',
          collapsible: true,
          items: [
            { name: 'äºšå…‹åŠ›ç”²ç‰‡', price: '$42èµ·' },
            { name: 'ç»ç’ƒçº¤ç»´ç”²', price: '$50èµ·' },
            { name: 'UVå‡èƒ¶ç”²', price: '$65èµ·' },
            { name: 'ç”²ç‰‡å¡«å……', price: '$32èµ·' },
            { name: 'ç”²ç‰‡å¸é™¤', price: '$15' }
          ]
        },
        {
          title: 'ğŸŒŸ å¢å€¼æœåŠ¡',
          collapsible: true,
          items: [
            { name: 'æ‰‹éƒ¨æŒ‰æ‘©', price: '$8' },
            { name: 'è¶³éƒ¨å»è§’è´¨', price: '$10' },
            { name: 'æŒ‡ç”²ä¿®æŠ¤ç²¾å', price: '$12' },
            { name: 'å»¶é•¿æŠ¤ç†æ—¶é—´', price: '$20/15åˆ†é’Ÿ' },
            { name: 'VIPåŒ…é—´', price: '+$15' }
          ]
        },
        {
          title: 'ğŸ å¥—é¤æ¨è',
          collapsible: false,
          features: [
            'ğŸ’– æƒ…ä¾£å¥—é¤ - ç¾ç”²+ç¾è¶³ $80',
            'ğŸ‘­ é—ºèœœå¥—é¤ - 2äººç¾ç”² $50',
            'ğŸŒ¸ è±ªåSPA - å…¨å¥—æŠ¤ç† $120',
            'â­ æœˆåº¦ä¼šå‘˜ - äº«8æŠ˜ä¼˜æƒ '
          ]
        }
      ],
      action: 'é¢„çº¦æœåŠ¡'
    },
    member: {
      title: 'ğŸ‘‘ ä¼šå‘˜ä¸­å¿ƒ',
      sections: [
        {
          title: 'ğŸ’ ä¼šå‘˜ç­‰çº§',
          collapsible: true,
          items: [
            { name: 'é“¶å¡ä¼šå‘˜', price: 'æ¶ˆè´¹æ»¡$200' },
            { name: 'é‡‘å¡ä¼šå‘˜', price: 'æ¶ˆè´¹æ»¡$500' },
            { name: 'VIPä¼šå‘˜', price: 'æ¶ˆè´¹æ»¡$1000' }
          ]
        },
        {
          title: 'ğŸ ä¼šå‘˜ç¦åˆ©',
          collapsible: true,
          items: [
            { name: 'ç”Ÿæ—¥ç‰¹æƒ ', price: '5æŠ˜ä¼˜æƒ ' },
            { name: 'ç§¯åˆ†è¿”ç°', price: 'æ¶ˆè´¹1å…ƒ=1ç§¯åˆ†' },
            { name: 'ä¼˜å…ˆé¢„çº¦', price: 'ä¸“å±æ—¶æ®µ' },
            { name: 'å…è´¹å‡çº§', price: 'æœåŠ¡å‡çº§' },
            { name: 'æ¨èå¥–åŠ±', price: 'æ¯äºº$10' }
          ]
        },
        {
          title: 'â­ ä¼šå‘˜æŠ˜æ‰£',
          collapsible: true,
          items: [
            { name: 'é“¶å¡ä¼šå‘˜', price: '9æŠ˜ä¼˜æƒ ' },
            { name: 'é‡‘å¡ä¼šå‘˜', price: '8.5æŠ˜ä¼˜æƒ ' },
            { name: 'VIPä¼šå‘˜', price: '8æŠ˜ä¼˜æƒ ' }
          ]
        },
        {
          title: 'ğŸ‰ ç‰¹æ®Šæ´»åŠ¨',
          collapsible: false,
          features: [
            'ğŸŒ¸ æ¯æœˆç¬¬ä¸€å‘¨ - æ–°ä¼šå‘˜äº«8æŠ˜',
            'ğŸ’ èŠ‚æ—¥æ´»åŠ¨ - é¢å¤–ä¼˜æƒ åˆ¸',
            'ğŸŠ å‘¨å¹´åº†å…¸ - æŠ½å¥–æ´»åŠ¨',
            'ğŸ‘¯ æ¨èå¥½å‹ - åŒæ–¹è·èµ $10'
          ]
        }
      ],
      action: 'ç«‹å³æ³¨å†Œ'
    }
  },
  en: {
    book: {
      title: 'ğŸ“… Book',
      sections: [
        {
          title: 'ğŸ’… MANICURE',
          collapsible: true,
          items: [
            { name: 'Regular Mani', price: '$12' },
            { name: 'Color Gel Mani', price: '$30' },
            { name: 'Powder Gel Mani', price: '$45' }
          ]
        },
        {
          title: 'ğŸ¦¶ PEDICURE',
          collapsible: true,
          items: [
            { name: 'Regular Pedi', price: '$22' },
            { name: 'Color Gel Pedi', price: '$40' }
          ]
        },
        {
          title: 'ğŸ§– SPA',
          collapsible: true,
          items: [
            { name: 'Basic Mani', price: '$22' },
            { name: 'Basic Pedi', price: '$40' },
            { name: 'Deluxe Pedi', price: '$55' },
            { name: 'Hot Stone', price: '$80' },
            { name: 'Jelly', price: '$90' }
          ]
        },
        {
          title: 'ğŸ’ FILL IN',
          collapsible: true,
          items: [
            { name: 'Acrylic', price: '$32' },
            { name: 'Fiberglass', price: '$35' },
            { name: 'UV Gel', price: '$40' }
          ]
        },
        {
          title: 'âœ¨ FULL SET',
          collapsible: true,
          items: [
            { name: 'Acrylic', price: '$42' },
            { name: 'Fiberglass', price: '$50' },
            { name: 'UV Gel', price: '$65' }
          ]
        },
        {
          title: 'ğŸ€ FRENCH',
          collapsible: true,
          items: [
            { name: 'Acrylic French', price: '$60' },
            { name: 'UV Gel French', price: '$75' }
          ]
        },
        {
          title: 'ğŸ“ Contact',
          collapsible: false,
          features: [
            'ğŸ“± (516) 371-4557',
            'ğŸ’¬ (917) 330-5781',
            'ğŸ“ 97 Doughty Blvd Inwood NY 11096',
            'â° Tue-Sun 9:58-18:58'
          ]
        }
      ],
      action: 'Book Now'
    },
    services: {
      title: 'ğŸ’… Services',
      sections: [
        {
          title: 'ğŸ’… Manicure Care',
          collapsible: true,
          items: [
            { name: 'Classic Manicure', price: 'From $12' },
            { name: 'Gel Manicure', price: 'From $30' },
            { name: 'Powder Gel Manicure', price: 'From $45' },
            { name: 'Nail Repair', price: 'From $8' },
            { name: 'Nail Buffing', price: '$5' }
          ]
        },
        {
          title: 'ğŸ¦¶ Pedicure Care',
          collapsible: true,
          items: [
            { name: 'Classic Pedicure', price: 'From $22' },
            { name: 'Gel Pedicure', price: 'From $40' },
            { name: 'Callus Removal', price: '+$10' },
            { name: 'Foot Massage', price: '+$15' },
            { name: 'Heel Treatment', price: '+$8' }
          ]
        },
        {
          title: 'ğŸ¨ Nail Art',
          collapsible: true,
          items: [
            { name: 'French Tips', price: '+$10' },
            { name: 'Ombre Design', price: '+$15' },
            { name: 'Hand Painting', price: '+$20' },
            { name: 'Crystal Decoration', price: 'From +$5' },
            { name: 'Rhinestones', price: 'From +$3' }
          ]
        },
        {
          title: 'âœ¨ Special Treatments',
          collapsible: true,
          items: [
            { name: 'Paraffin Wax', price: '+$12' },
            { name: 'Hot Stone Massage', price: '+$25' },
            { name: 'Deep Moisturizing', price: '+$15' },
            { name: 'Jelly Spa', price: '+$20' },
            { name: 'Aromatherapy', price: '+$10' }
          ]
        },
        {
          title: 'ğŸ’ Nail Extensions',
          collapsible: true,
          items: [
            { name: 'Acrylic Full Set', price: 'From $42' },
            { name: 'Fiberglass', price: 'From $50' },
            { name: 'UV Gel Full Set', price: 'From $65' },
            { name: 'Fill-in Service', price: 'From $32' },
            { name: 'Removal', price: '$15' }
          ]
        },
        {
          title: 'ğŸŒŸ Add-On Services',
          collapsible: true,
          items: [
            { name: 'Hand Massage', price: '$8' },
            { name: 'Foot Scrub', price: '$10' },
            { name: 'Nail Treatment', price: '$12' },
            { name: 'Extended Time', price: '$20/15min' },
            { name: 'VIP Room', price: '+$15' }
          ]
        },
        {
          title: 'ğŸ Package Deals',
          collapsible: false,
          features: [
            'ğŸ’– Couple Package - Mani+Pedi $80',
            'ğŸ‘­ Friends Package - 2 Manicures $50',
            'ğŸŒ¸ Luxury SPA - Full Treatment $120',
            'â­ Monthly Member - 20% Off'
          ]
        }
      ],
      action: 'Book Now'
    },
    member: {
      title: 'ğŸ‘‘ Membership',
      sections: [
        {
          title: 'ğŸ’ Member Tiers',
          collapsible: true,
          items: [
            { name: 'Silver Member', price: 'Spend $200+' },
            { name: 'Gold Member', price: 'Spend $500+' },
            { name: 'VIP Member', price: 'Spend $1000+' }
          ]
        },
        {
          title: 'ğŸ Member Benefits',
          collapsible: true,
          items: [
            { name: 'Birthday Special', price: '50% Off' },
            { name: 'Points Rewards', price: '$1 = 1 Point' },
            { name: 'Priority Booking', price: 'Exclusive Slots' },
            { name: 'Free Upgrade', price: 'Service Upgrade' },
            { name: 'Referral Bonus', price: '$10 Each' }
          ]
        },
        {
          title: 'â­ Member Discounts',
          collapsible: true,
          items: [
            { name: 'Silver Member', price: '10% Off' },
            { name: 'Gold Member', price: '15% Off' },
            { name: 'VIP Member', price: '20% Off' }
          ]
        },
        {
          title: 'ğŸ‰ Special Events',
          collapsible: false,
          features: [
            'ğŸŒ¸ First Week Monthly - 20% Off New Members',
            'ğŸ’ Holiday Events - Extra Coupons',
            'ğŸŠ Anniversary - Lucky Draw',
            'ğŸ‘¯ Refer Friends - Both Get $10'
          ]
        }
      ],
      action: 'Join Now'
    }
  },
  es: {
    book: {
      title: 'ğŸ“… Reservar',
      sections: [
        {
          title: 'ğŸ’… MANICURE',
          collapsible: true,
          items: [
            { name: 'Regular Mani', price: '$12' },
            { name: 'Color Gel Mani', price: '$30' },
            { name: 'Powder Gel Mani', price: '$45' }
          ]
        },
        {
          title: 'ğŸ¦¶ PEDICURE',
          collapsible: true,
          items: [
            { name: 'Regular Pedi', price: '$22' },
            { name: 'Color Gel Pedi', price: '$40' }
          ]
        },
        {
          title: 'ğŸ§– SPA',
          collapsible: true,
          items: [
            { name: 'Basic Mani', price: '$22' },
            { name: 'Basic Pedi', price: '$40' },
            { name: 'Deluxe Pedi', price: '$55' },
            { name: 'Hot Stone', price: '$80' },
            { name: 'Jelly', price: '$90' }
          ]
        },
        {
          title: 'ğŸ’ FILL IN',
          collapsible: true,
          items: [
            { name: 'Acrylic', price: '$32' },
            { name: 'Fiberglass', price: '$35' },
            { name: 'UV Gel', price: '$40' }
          ]
        },
        {
          title: 'âœ¨ FULL SET',
          collapsible: true,
          items: [
            { name: 'Acrylic', price: '$42' },
            { name: 'Fiberglass', price: '$50' },
            { name: 'UV Gel', price: '$65' }
          ]
        },
        {
          title: 'ğŸ€ FRENCH',
          collapsible: true,
          items: [
            { name: 'Acrylic French', price: '$60' },
            { name: 'UV Gel French', price: '$75' }
          ]
        },
        {
          title: 'ğŸ“ Contacto',
          collapsible: false,
          features: [
            'ğŸ“± (516) 371-4557',
            'ğŸ’¬ (917) 330-5781',
            'ğŸ“ 97 Doughty Blvd Inwood NY 11096',
            'â° Mar-Dom 9:58-18:58'
          ]
        }
      ],
      action: 'Reservar'
    },
    services: {
      title: 'ğŸ’… Servicios',
      sections: [
        {
          title: 'ğŸ’… Cuidado de Manos',
          collapsible: true,
          items: [
            { name: 'Manicure ClÃ¡sico', price: 'Desde $12' },
            { name: 'Manicure en Gel', price: 'Desde $30' },
            { name: 'Manicure en Polvo', price: 'Desde $45' },
            { name: 'ReparaciÃ³n de UÃ±as', price: 'Desde $8' },
            { name: 'Pulido de UÃ±as', price: '$5' }
          ]
        },
        {
          title: 'ğŸ¦¶ Cuidado de Pies',
          collapsible: true,
          items: [
            { name: 'Pedicure ClÃ¡sico', price: 'Desde $22' },
            { name: 'Pedicure en Gel', price: 'Desde $40' },
            { name: 'EliminaciÃ³n de Callos', price: '+$10' },
            { name: 'Masaje de Pies', price: '+$15' },
            { name: 'Tratamiento de Talones', price: '+$8' }
          ]
        },
        {
          title: 'ğŸ¨ Arte de UÃ±as',
          collapsible: true,
          items: [
            { name: 'Francesa', price: '+$10' },
            { name: 'Degradado', price: '+$15' },
            { name: 'DiseÃ±o Pintado', price: '+$20' },
            { name: 'DecoraciÃ³n Cristal', price: 'Desde +$5' },
            { name: 'PedrerÃ­a', price: 'Desde +$3' }
          ]
        },
        {
          title: 'âœ¨ Tratamientos Especiales',
          collapsible: true,
          items: [
            { name: 'Cera de Parafina', price: '+$12' },
            { name: 'Masaje Piedras', price: '+$25' },
            { name: 'HidrataciÃ³n Profunda', price: '+$15' },
            { name: 'Jelly Spa', price: '+$20' },
            { name: 'Aromaterapia', price: '+$10' }
          ]
        },
        {
          title: 'ğŸ’ Extensiones',
          collapsible: true,
          items: [
            { name: 'AcrÃ­lico Completo', price: 'Desde $42' },
            { name: 'Fibra de Vidrio', price: 'Desde $50' },
            { name: 'UV Gel Completo', price: 'Desde $65' },
            { name: 'Relleno', price: 'Desde $32' },
            { name: 'RemociÃ³n', price: '$15' }
          ]
        },
        {
          title: 'ğŸŒŸ Servicios Adicionales',
          collapsible: true,
          items: [
            { name: 'Masaje de Manos', price: '$8' },
            { name: 'ExfoliaciÃ³n de Pies', price: '$10' },
            { name: 'Tratamiento de UÃ±as', price: '$12' },
            { name: 'Tiempo Extendido', price: '$20/15min' },
            { name: 'Sala VIP', price: '+$15' }
          ]
        },
        {
          title: 'ğŸ Paquetes',
          collapsible: false,
          features: [
            'ğŸ’– Paquete Pareja - Mani+Pedi $80',
            'ğŸ‘­ Paquete Amigas - 2 Manicures $50',
            'ğŸŒ¸ SPA de Lujo - Completo $120',
            'â­ Miembro Mensual - 20% Descuento'
          ]
        }
      ],
      action: 'Reservar'
    },
    member: {
      title: 'ğŸ‘‘ MembresÃ­a',
      sections: [
        {
          title: 'ğŸ’ Niveles',
          collapsible: true,
          items: [
            { name: 'Miembro Plata', price: 'Gasto $200+' },
            { name: 'Miembro Oro', price: 'Gasto $500+' },
            { name: 'Miembro VIP', price: 'Gasto $1000+' }
          ]
        },
        {
          title: 'ğŸ Beneficios',
          collapsible: true,
          items: [
            { name: 'CumpleaÃ±os', price: '50% Descuento' },
            { name: 'Puntos', price: '$1 = 1 Punto' },
            { name: 'Reserva Prioritaria', price: 'Horarios VIP' },
            { name: 'Mejora Gratis', price: 'Upgrade Servicio' },
            { name: 'Referir Amigos', price: '$10 c/u' }
          ]
        },
        {
          title: 'â­ Descuentos',
          collapsible: true,
          items: [
            { name: 'Miembro Plata', price: '10% Descuento' },
            { name: 'Miembro Oro', price: '15% Descuento' },
            { name: 'Miembro VIP', price: '20% Descuento' }
          ]
        },
        {
          title: 'ğŸ‰ Eventos',
          collapsible: false,
          features: [
            'ğŸŒ¸ Primera Semana - 20% Nuevos Miembros',
            'ğŸ’ DÃ­as Festivos - Cupones Extra',
            'ğŸŠ Aniversario - Sorteo',
            'ğŸ‘¯ Referir Amigos - $10 para Ambos'
          ]
        }
      ],
      action: 'Registrarse'
    }
  }
};

function openFunctionPanel(type) {
  const panel = document.getElementById('functionPanel');
  const overlay = document.getElementById('panelOverlay');
  const title = document.getElementById('panelTitle');
  const contentArea = document.getElementById('panelContentArea');
  
  AudioManager.playSound('panelSlide');
  
  const content = panelContents[currentLanguage][type];
  
  if (type === 'book') {
    const now = new Date();
    const hours = String(now.getHours()).padStart(2, '0');
    const minutes = String(now.getMinutes()).padStart(2, '0');
    const seconds = String(now.getSeconds()).padStart(2, '0');
    const month = now.getMonth() + 1;
    const date = now.getDate();
    const weekdays = ['å‘¨æ—¥', 'å‘¨ä¸€', 'å‘¨äºŒ', 'å‘¨ä¸‰', 'å‘¨å››', 'å‘¨äº”', 'å‘¨å…­'];
    const weekday = weekdays[now.getDay()];
    
    const titleText = content.title;
    const timeStr = `${hours}:${minutes}:${seconds}`;
    const dateStr = `${month}æœˆ${date}æ—¥ ${weekday}`;
    
    if (currentLanguage === 'zh') {
      title.innerHTML = `
        <div class="panel-title-container">
          <div class="panel-title-text">${titleText}</div>
          <div class="panel-title-clock">
            <div class="panel-clock-time-inline" id="panelClockTimeInline">${timeStr}</div>
            <div class="panel-clock-date-inline" id="panelClockDateInline">${dateStr}</div>
          </div>
        </div>
      `;
    } else if (currentLanguage === 'en') {
      const monthNames = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
      const weekdaysEn = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
      title.innerHTML = `
        <div class="panel-title-container">
          <div class="panel-title-text">${titleText}</div>
          <div class="panel-title-clock">
            <div class="panel-clock-time-inline" id="panelClockTimeInline">${timeStr}</div>
            <div class="panel-clock-date-inline" id="panelClockDateInline">${monthNames[month-1]} ${date}, ${weekdaysEn[now.getDay()]}</div>
          </div>
        </div>
      `;
    } else {
      const monthNamesEs = ['Ene', 'Feb', 'Mar', 'Abr', 'May', 'Jun', 'Jul', 'Ago', 'Sep', 'Oct', 'Nov', 'Dic'];
      const weekdaysEs = ['Dom', 'Lun', 'Mar', 'MiÃ©', 'Jue', 'Vie', 'SÃ¡b'];
      title.innerHTML = `
        <div class="panel-title-container">
          <div class="panel-title-text">${titleText}</div>
          <div class="panel-title-clock">
            <div class="panel-clock-time-inline" id="panelClockTimeInline">${timeStr}</div>
            <div class="panel-clock-date-inline" id="panelClockDateInline">${date} ${monthNamesEs[month-1]}, ${weekdaysEs[now.getDay()]}</div>
          </div>
        </div>
      `;
    }
  } else {
    title.textContent = content.title;
  }
  
  let html = '';
  content.sections.forEach((section, sectionIndex) => {
    // å¦‚æœæ˜¯å¯å±•å¼€çš„é¡¹ç›®
    if (section.collapsible && section.items) {
      html += `<div class="expandable-section">`;
      html += `
        <div class="section-header" onclick="toggleSection(${sectionIndex})">
          <div class="section-title">${section.title}</div>
          <div class="expand-icon" id="icon-${sectionIndex}">â–¼</div>
        </div>
      `;
      html += `<div class="section-details" id="details-${sectionIndex}">`;
      section.items.forEach(item => {
        html += `
          <div class="detail-item">
            <div class="detail-name">${item.name}</div>
            <div class="detail-price">${item.price}</div>
          </div>
        `;
      });
      html += `</div></div>`;
    } 
    // å¦‚æœæ˜¯æ™®é€šé¡¹ç›®
    else {
      html += `<div class="content-section">`;
      html += `<div class="section-title">${section.title}</div>`;
      if (section.text) html += `<div class="section-text">${section.text}</div>`;
      if (section.features) {
        html += `<ul class="feature-list">`;
        section.features.forEach(f => {
          html += `<li class="feature-item">${f}</li>`;
        });
        html += `</ul>`;
      }
      html += `</div>`;
    }
  });
  
  html += `<button class="action-button">${content.action}</button>`;
  contentArea.innerHTML = html;
  
  overlay.classList.add('show');
  panel.classList.add('show');
  
  if (type === 'book') {
    updateClock();
  }
}

function closeFunctionPanel() {
  document.getElementById('functionPanel').classList.remove('show');
  document.getElementById('panelOverlay').classList.remove('show');
}

function toggleSection(index) {
  const details = document.getElementById(`details-${index}`);
  const icon = document.getElementById(`icon-${index}`);
  
  if (details && icon) {
    const isExpanded = details.classList.contains('expanded');
    
    if (isExpanded) {
      details.classList.remove('expanded');
      icon.classList.remove('expanded');
    } else {
      details.classList.add('expanded');
      icon.classList.add('expanded');
    }
    
    AudioManager.playSound('panelSlide');
  }
}

function clickButton(type) {
  AudioManager.playVoice('button' + type.charAt(0).toUpperCase() + type.slice(1));
  setTimeout(() => openFunctionPanel(type), 100);
}

window.addEventListener('resize', () => {
  canvas.width = innerWidth;
  canvas.height = innerHeight;
});
</script>
</body>
</html>
